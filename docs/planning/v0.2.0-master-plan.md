# Dad Cam v0.2.0 - Master Plan

Status: Planning
Created: 2026-01-28

---

## What is Dad Cam?

A paid tool for making old school cameras useable in the modern day, plus automatic "VHS edits". We rent out dad cameras and need an app to automate the process and make it useable for end users.

- Paid app for anyone ($99 one-time)
- Free during rental (pre-generated keys)
- Free trial that blocks import/export after 14 days
- Cross-platform: Mac, Linux, Windows
- VHS Edits: J & L audio blending in one long timeline
- Opening title text (starts 5 seconds in, adjustable in dev menu)
- Sidecar files and EXIF dumps
- Dev menu for formulas and master camera library

---

## What Exists Today (v0.1.x)

### Backend (Rust/Tauri) - 39 files, 38 Tauri commands

| Module | Commands | What It Does |
|--------|----------|-------------|
| `commands/library.rs` | 5 | open, close, create, get_root, validate |
| `commands/clips.rs` | 4 | get_clips, get_clip, get_clips_filtered, get_clip_view |
| `commands/tags.rs` | 2 | toggle_tag, set_tag |
| `commands/scoring.rs` | 6 | score_clip, get_best_clips, set_override, queue_jobs |
| `commands/settings.rs` | 6 | get/save settings, get/set mode, recent libraries |
| `commands/stills.rs` | 1 | export_still (single frame only) |
| `commands/events.rs` | 8 | CRUD events, add/remove clips, date grouping |
| `ingest/` | -- | discover, copy, orchestration (CLI-style, no GUI feedback) |
| `metadata/` | -- | ffprobe, exiftool extraction |
| `camera/mod.rs` | -- | profile matching (3 hardcoded: Sony, Canon, Panasonic) |
| `preview/` | -- | proxy (720p), thumbnails, sprite sheets |
| `scoring/` | -- | scene, audio, sharpness, motion analysis |
| `hash/` | -- | BLAKE3 hashing |
| `jobs/` | -- | durable job queue (export type exists but says "not yet implemented") |
| `db/` | -- | SQLite schema, 3 migrations, init |

**Database: 3 migrations, 15 tables.** Core (libraries, assets, clips, clip_assets, camera_profiles, tags, clip_tags, jobs, job_logs, volumes, fingerprints, ingest_files, asset_volumes), Scoring (clip_scores, clip_score_overrides), Events (events, event_clips).

### Frontend (React/TypeScript) - 43 files

| Area | What It Does |
|------|-------------|
| `App.tsx` | Root routing, personal/pro mode |
| `MainLayout.tsx` | Header + LeftNav wrapper |
| `LeftNav.tsx` | Sidebar with 4 sections: Library, Events, Dates, Settings |
| `LibraryView.tsx` | Main workspace (welcome/clips/events/dates/settings sub-views) |
| `LibraryDashboard.tsx` | Pro mode: multi-library selection |
| `WelcomeDashboard.tsx` | Personal mode: landing page with Import/Stills/Export/Browse |
| `ClipGrid.tsx` | Virtualized responsive grid |
| `FilterBar.tsx` | Filter (all/favorites/bad/unreviewed), search, sort, date range |
| `VideoPlayer.tsx` | Modal player with 15+ keyboard shortcuts |
| `EventView.tsx`, `DateView.tsx` | Event and date detail views |
| `SettingsView.tsx` | Full settings page (mode selector, about) |
| `BestClipsPanel.tsx`, `Score*.tsx` | Scoring UI (badges, breakdown, status) |
| `nav/` | LibrarySection, EventsSection, DatesSection, SettingsSection |
| `modals/` | CreateEvent, EditEvent, AddToEvent |
| `types/` | clips, events, scoring, settings |
| `api/` | clips, events, scoring, settings, stills |
| `App.css` | Single global stylesheet (light default, dark via .dark-mode class) |

### Current Settings Type

```typescript
type AppMode = 'personal' | 'pro';
interface AppSettings { mode: AppMode; recentLibraries: RecentLibrary[] }
```

---

## v0.2.0 Scope

1. Settings v2 (expanded settings, mode rename, feature flags, dev menu config)
2. Licensing system (14-day trial, $99 purchase, soft lock, Gumroad)
3. VHS export (J & L blending, title text, timeline builder -- all new, not built yet)
4. Import dialog (GUI with event assignment, camera detection, progress)
5. Camera system (bundled DB, custom "Dad Cams", confidence matching)
6. LeftNav additions (Favorites link, Cameras tab)
7. First-run wizard (Simple vs Advanced mode selection)
8. Feature toggles (screen grabs, face detection, best clips, cameras tab)
9. Dev menu (formulas, camera DB, license tools, debug)
10. Camera registration (USB detection, EXIF dump -- riskiest item)
11. Theme toggle wiring (CSS done, need the switch)
12. Terminology rename (Library > Project, Personal > Simple -- last)

### Not In Scope

- FireWire cameras
- VHS/MiniDV tape capture
- Multi-view camera sync
- Cloud features
- Subscription model

---

## User Experience Modes

### Simple Mode (Default)

| Setting | Value |
|---------|-------|
| Projects | Single ("Default Project") |
| First run | Prompt for folder location once |
| Cameras tab | Hidden |
| Camera profile | Generic fallback unless in bundled DB or registered Dad Cam |
| Theme | Light only (no toggle) |
| Feature toggles | Hidden (not configurable) |
| Dashboard | None (straight to project) |
| Dev menu | Hidden |
| Performance | Target low-end PCs |

### Advanced Mode

| Setting | Value |
|---------|-------|
| Projects | Multiple supported |
| First run | Navigate to Projects dashboard |
| Cameras tab | Visible |
| Camera profile | Register specific cameras ("Dad Cams") |
| Theme | Light/Dark toggle |
| Feature toggles | Visible and configurable |
| Dashboard | Projects dashboard on launch |
| Dev menu | Full access (Cmd+Shift+D) |

"Dad Cams" = your registered rental fleet cameras. Priority matching over bundled DB. Custom LUTs, notes, tracking info. Battery/charger info for rental management.

### Feature Toggle Defaults

| Feature | Simple | Advanced |
|---------|--------|----------|
| Screen grabs | On | On |
| Face detection | **Off** (ML heavy, low-end PCs) | On |
| Best clips | On | On |
| Cameras tab | Off (hidden) | On |

Simple mode hides the toggles entirely. Advanced mode shows them in Settings.

---

## Left Navigation

### Simple Mode

```
PROJECT NAME
+-- All Clips
+-- Favorites           <-- link, sets filter on existing ClipGrid
+-- Events
|   +-- Event 1
|   +-- Event 2
|   +-- [+ New Event]
+-- Dates
|   +-- 2024
|   |   +-- January
|   |   +-- February
|   +-- 2023
+-- Settings
```

### Advanced Mode

```
PROJECT NAME
+-- All Clips
+-- Favorites
+-- Cameras             <-- Advanced only
|   +-- Sony HDR-CX405
|   +-- Canon VIXIA
|   +-- Unknown Camera
+-- Events
|   +-- Event 1
|   |   +-- [Camera 1]
|   |   +-- [Camera 2]
|   +-- Event 2
|   +-- [+ New Event]
+-- Dates
|   +-- 2024
|   +-- 2023
+-- Settings
```

Note: Favorites is NOT a separate view component. It's a nav link that navigates to ClipGrid with `filter: 'favorites'` pre-set. No new FavoritesView.tsx needed.

---

## Camera System

Detection via EXIF metadata. Unknown cameras use generic profile silently (no prompts).

**Bundled:** `resources/cameras/canonical.json`
**Custom:** `~/.dadcam/custom_cameras.json` (user-registered "Dad Cams")

| Priority | Source | Confidence |
|----------|--------|------------|
| 1 | Custom camera (USB fingerprint) | 100% |
| 2 | Custom camera (serial number) | 95% |
| 3 | Custom camera (make + model) | 80% |
| 4 | Bundled database (make + model) | 80% |
| 5 | Bundled database (filename pattern) | 70% |
| 6 | Unknown (generic profile) | 0% (silent) |

**canonical.json source:** TBD. Options: open-source EXIF database, manual curation, or start with the 3 hardcoded profiles and grow. The camera system MUST work without it (custom cameras + generic fallback). Bundled DB is a nice-to-have, not a blocker.

---

## VHS Edit System

All new. Job runner has the "export" type stub but says "not yet implemented."

J & L audio blending with all footage in one long timeline.

- J-cut: Audio from next clip starts before video transition
- L-cut: Audio from current clip continues after video transition
- Blend duration: 500ms default (adjustable in Dev Menu)

**Opening Title:**
- Plain text field in export dialog (optional, blank = no title)
- Starts at 5 seconds (adjustable in Dev Menu)
- Duration: 3 seconds (fade in 0.5s, hold 2s, fade out 0.5s)
- Style: centered, Braun typography, semi-transparent background
- FFmpeg drawtext filter

**Selection Modes:** by date, by event, by favorites, all (above score threshold)
**Ordering:** chronological (default), score desc, score asc, shuffle

---

## Import Flow

Current: folder picker button that calls `start_ingest`. No event assignment, no progress UI, no camera detection feedback. Needs a proper dialog.

```
User clicks "Import Footage"
  --> Folder Picker
  --> "Assign to Event" dropdown
      +-- [Existing Event]
      +-- [+ Create New Event] --> Name input
      +-- [No Event]
  --> [Start Import]
  --> Per file:
      1. Copy/reference to project
      2. Extract EXIF metadata
      3. Detect camera (Dad Cam > bundled > generic)
      4. Generate proxy, thumbnail, sprite
      5. Add to DB with event_id and camera_id
  --> Import Complete Summary:
      - 47 clips imported
      - Cameras: Sony HDR-CX405 (23), Canon VIXIA (18), Unknown (6)
      - Event: "Birthday Party 2024"
```

---

## Dev Menu

Access: Cmd+Shift+D (Mac) / Ctrl+Shift+D (Win/Linux)
Alternative: Settings > About > click version 7 times

```
Dev Menu
+-- Formulas
|   +-- Title Start Time: [5] seconds
|   +-- J & L Blend Duration: [500] ms
|   +-- Score Weights (scene/audio/sharpness/motion)
+-- Camera Database
|   +-- View All Cameras (bundled + custom)
|   +-- Register New Camera
|   +-- Import/Export JSON
+-- License Tools
|   +-- View Current License State
|   +-- Generate Rental Key
|   +-- Clear License (test trial)
|   +-- Set Dev Mode
+-- Debug (Dev license only)
    +-- View Logs
    +-- Database Browser (SQLite)
    +-- Raw SQL (DCAM-D key required)
    +-- FFmpeg Test
    +-- Clear Caches
```

Note: Raw SQL execution is gated behind DCAM-D (dev) license key. The easter egg alone does NOT grant raw SQL access.

---

## Licensing System

Philosophy: Don't fight piracy. Make buying easier than pirating.

| Tier | Price | Who |
|------|-------|-----|
| Trial | Free | Anyone (14 days, full features, then soft lock) |
| Personal | $99 | Anyone (one-time, lifetime) |
| Rental | Free | Clients (key included with rental) |
| Dev | Free | Hardcoded |

**Soft Lock (after 14 days):**
CAN: open app, view/browse, play clips.
CANNOT: import, export, auto-edit. Watermark on exports.

**Key format:** `DCAM-P-XXXX-XXXX-XXXX` (Purchased), `DCAM-R-` (Rental), `DCAM-D-` (Dev)
**Validation:** Local only, no phone home, stored in system keychain.
**Purchase:** Gumroad (handles payments, keys, refunds).

---

## Existing User Migration (v0.1.x to v0.2.0)

| What | Migration |
|------|-----------|
| Settings | v1 auto-migrates to v2. `personal` > `simple`, `pro` > `advanced`. `firstRunCompleted: true` (skip wizard). |
| Libraries on disk | `.dadcam/` folders unchanged. Code says "project" but DB table stays `libraries`. |
| First-run wizard | Skipped for existing users (firstRunCompleted set true on migration). |
| Trial | Starts on first v0.2.0 launch. Existing users get full 14 days. |
| Feature flags | Set to defaults for detected mode. |
| Theme | Set to `light` for everyone. |

---

## Decisions Log

| Question | Decision |
|----------|----------|
| Default Project location | Prompt for folder once, never ask again |
| Opening title input | In export dialog (per-export) |
| Unknown camera handling | Use generic profile silently (no prompt) |
| Default theme | Light mode |
| Dark mode availability | Advanced users only |
| Rental key strategy | Pre-generated (batch of 100) |
| Payment processor | Gumroad |
| FavoritesView component | No. Use nav link that sets filter on existing ClipGrid. |
| Raw SQL in debug | Dev license (DCAM-D) only |
| canonical.json source | TBD. System works without it. Not a blocker. |
| Face detection Simple mode | Off by default (low-end PC target) |

### Open Questions

1. Title font/style - use Braun typography or allow customization?
2. Rental key expiration - should rental keys expire?
3. Multi-machine licenses - one key per machine or transferable?

---

## Backend Checklist

Everything in `src-tauri/src/`. Ordered by implementation priority.

### 1. Settings v2

Current settings are minimal (`mode` + `recentLibraries`). Foundation for everything.

- [ ] `commands/settings.rs` -- expand AppSettings struct:
  - `version: u32` (2)
  - `theme: String` ("light" or "dark")
  - `firstRunCompleted: bool`
  - `defaultProjectPath: Option<String>`
  - `lastProjectPath: Option<String>`
  - `featureFlags: FeatureFlags` { screenGrabs, faceDetection, bestClips, camerasTab }
  - `devMenu: DevMenuSettings` { titleStartTime, blendDuration, scoreWeights }
  - `license: Option<LicenseState>`
- [ ] `commands/settings.rs` -- v1-to-v2 migration on load (map personal>simple, pro>advanced, set firstRunCompleted=true for existing users)
- [ ] `commands/settings.rs` -- new commands: `get_dev_menu_settings`, `save_dev_menu_settings`

### 2. Licensing System

The business model. Nothing exists today.

- [ ] New: `license/mod.rs` -- license state management
- [ ] New: `license/machine_id.rs` -- BLAKE3 hash of hostname + username + hardware serial
- [ ] New: `license/key.rs` -- key format (DCAM-X-XXXX-XXXX-XXXX), checksum validation
- [ ] New: `license/trial.rs` -- trial start date storage, days remaining, is_locked check
- [ ] New: `license/keychain.rs` -- system keychain (macOS Keychain, Windows Credential Store, Linux Secret Service)
- [ ] New: `commands/license.rs` -- commands:
  - `get_license_state` -- current license info
  - `activate_license` -- validate and store key
  - `get_trial_info` -- days remaining, is_locked
  - `is_feature_available` -- check if feature is allowed under soft lock
  - `generate_rental_key` -- dev menu: generate DCAM-R key
  - `get_machine_id` -- dev menu: show machine ID
- [ ] Feature gating in existing commands: check license before import, export, auto-edit
- [ ] Watermark injection for unlicensed exports (once export exists)

### 3. VHS Export System

Core product feature. Job runner has "export" stub, not implemented.

- [ ] New: `export/mod.rs` -- export orchestration, job integration
- [ ] New: `export/timeline.rs` -- build clip timeline (selection: by_date, by_event, by_favorites, all; ordering: chronological, score_desc, score_asc, shuffle)
- [ ] New: `export/ffmpeg.rs` -- FFmpeg command builder:
  - Video crossfade (xfade filter)
  - J & L audio crossfade (acrossfade filter)
  - Blend duration from dev menu settings
- [ ] New: `export/title.rs` -- title overlay config (drawtext filter, timing from dev menu)
- [ ] `jobs/runner.rs` -- implement "export" job type (currently returns "not yet implemented")
- [ ] New: `commands/export.rs` -- commands:
  - `start_vhs_export` -- start export job with selection mode, title text, ordering
  - `get_export_progress` -- poll progress
  - `get_export_history` -- list past exports

### 4. Import Enhancement

Current ingest works but has no GUI feedback, no event assignment, no camera detection during import.

- [ ] `ingest/mod.rs` -- accept optional event_id parameter
- [ ] `ingest/mod.rs` -- run camera detection during ingest, store camera_id on clip
- [ ] `ingest/mod.rs` -- emit Tauri events for progress (files discovered, copied, indexed)
- [ ] `commands/library.rs` -- new command: `start_import` (wraps start_ingest with event + camera + progress)

### 5. Camera System

Current `camera/mod.rs` has 3 hardcoded profiles. Needs expansion.

- [ ] `camera/mod.rs` -- load canonical.json at startup (if it exists, graceful fallback if not)
- [ ] `camera/mod.rs` -- load `~/.dadcam/custom_cameras.json`
- [ ] `camera/mod.rs` -- merged matching: custom first, then bundled, then generic
- [ ] `camera/mod.rs` -- confidence scoring per priority table
- [ ] `db/migrations.rs` -- migration 4: `ALTER TABLE clips ADD COLUMN camera_id INTEGER`
- [ ] `db/schema.rs` -- update clip queries to include camera_id
- [ ] New: `commands/cameras.rs` -- commands:
  - `get_cameras` -- list cameras detected in current project
  - `get_camera_clips` -- clips for specific camera
  - `get_camera_profiles` -- all profiles (bundled + custom)
  - `register_camera` -- save to custom_cameras.json
  - `get_exif_dump` -- full EXIF dump from sample file

### 6. Camera Registration (USB)

Riskiest item. Cross-platform USB detection may not work reliably. Prototype early, ship late.

- [ ] New: `camera/usb.rs` -- USB device detection:
  - macOS: `system_profiler SPUSBDataType -json`
  - Windows: WMI query
  - Linux: `lsusb -v` or `/sys/bus/usb/devices/`
- [ ] New: `camera/registration.rs` -- full registration flow:
  - Extract USB fingerprint (VID, PID, Serial)
  - EXIF dump from sample files
  - Save to `~/.dadcam/custom_cameras.json`
  - Battery/charger to `~/.dadcam/battery_types.json`, `chargers.json`
- [ ] `commands/cameras.rs` -- add: `get_usb_devices` command

### 7. Dev Menu Backend

- [ ] `commands/settings.rs` -- dev menu settings already in settings v2 struct
- [ ] New: `commands/debug.rs` -- commands:
  - `get_logs` -- read log file
  - `run_sql` -- execute raw SQL (requires DCAM-D license check)
  - `test_ffmpeg` -- verify FFmpeg is available and returns version
  - `clear_caches` -- delete proxies/thumbs/sprites, requeue generation
  - `export_database` -- copy .dadcam/dadcam.db to user-chosen path

### 8. Terminology Rename (Backend)

Last. Biggest diff, zero user value. Do after all features are built.

- [ ] `commands/library.rs` -- rename commands: open_library > open_project, close_library > close_project, create_library > create_project, get_library_root > get_project_root, validate_library_path > validate_project_path
- [ ] `commands/settings.rs` -- rename: add_recent_library > add_recent_project, remove_recent_library > remove_recent_project, get_recent_libraries > get_recent_projects
- [ ] `db/schema.rs` -- rename LibraryResponse > ProjectResponse, update query function names
- [ ] `lib.rs` -- update all command registrations
- [ ] `ingest/mod.rs` -- update library references in logs/comments
- [ ] DB table `libraries` stays as-is (not worth a migration for a name change)

---

## Frontend Checklist

Everything in `src/`. Ordered by implementation priority.

### 1. Settings v2 Types

- [ ] `types/settings.ts` -- expand AppSettings:
  ```
  version, mode, theme, firstRunCompleted, defaultProjectPath,
  lastProjectPath, recentProjects, featureFlags, devMenu, license
  ```
- [ ] `types/settings.ts` -- add types: FeatureFlags, DevMenuSettings, LicenseState, ThemeMode
- [ ] `types/settings.ts` -- AppMode stays 'personal' | 'pro' until rename step (keep working)
- [ ] `api/settings.ts` -- add: getDevMenuSettings, saveDevMenuSettings

### 2. Licensing Frontend

- [ ] New: `types/license.ts` -- LicenseState, TrialInfo types
- [ ] New: `api/license.ts` -- getLicenseState, activateLicense, getTrialInfo, isFeatureAvailable
- [ ] New: `components/LicensePrompt.tsx` -- trial expired dialog, "Buy Now" (Gumroad link), "I Have a Key" entry
- [ ] `components/MainLayout.tsx` -- trial countdown in footer (days 1-11: subtle text, days 12-14: banner)
- [ ] Feature gating: disable Import/Export buttons when soft-locked
- [ ] `components/WelcomeDashboard.tsx` -- show upgrade prompt when locked

### 3. Export Dialog + VHS

- [ ] New: `components/ExportDialog.tsx` -- selection mode (by date, event, favorites, all), title text input (optional), ordering, format/quality preset, progress display
- [ ] New: `api/export.ts` -- startVhsExport, getExportProgress, getExportHistory
- [ ] `components/WelcomeDashboard.tsx` -- "Export" button opens ExportDialog
- [ ] `components/ProjectView.tsx` (or LibraryView until rename) -- header export button

### 4. Import Dialog

- [ ] New: `components/ImportDialog.tsx` -- folder picker, event assignment dropdown (existing/new/none), create event inline, progress display (discovered/copied/indexed), camera detection results (Advanced), import summary with camera breakdown
- [ ] `components/WelcomeDashboard.tsx` -- "Import" button opens ImportDialog instead of bare folder picker
- [ ] LibraryView header -- "Import" button opens ImportDialog

### 5. Camera System Frontend

- [ ] New: `types/cameras.ts` -- CameraProfile, CameraMatch, UsbDevice types
- [ ] New: `api/cameras.ts` -- getCameras, getCameraClips, getCameraProfiles, registerCamera, getUsbDevices, getExifDump
- [ ] New: `components/CamerasTab.tsx` -- clips grouped by camera (Advanced only). Camera name, make, model, clip count. Unknown = "Unknown Camera" with generic icon.
- [ ] New: `components/nav/CamerasSection.tsx` -- camera list in LeftNav (Advanced only)

### 6. LeftNav Updates

- [ ] `components/LeftNav.tsx` -- add Favorites link (navigates to ClipGrid with filter='favorites', no new component)
- [ ] `components/LeftNav.tsx` -- add Cameras section (Advanced only, gated by featureFlags.camerasTab)
- [ ] New: `components/nav/CamerasSection.tsx` -- camera list nav
- [ ] `components/nav/DatesSection.tsx` -- collapsible year/month tree
- [ ] `components/nav/EventsSection.tsx` -- show camera breakdown within events (Advanced)
- [ ] LibraryView (or ProjectView after rename) -- add 'cameras' to view routing

### 7. First-Run Wizard

- [ ] New: `components/FirstRunWizard.tsx` -- Step 1: Simple vs Advanced. Step 2 (Simple): folder picker, create Default Project. Step 2 (Advanced): go to Projects dashboard. Save settings, set firstRunCompleted=true.
- [ ] `App.tsx` -- show wizard when firstRunCompleted is false

### 8. Feature Toggles

- [ ] `components/SettingsView.tsx` -- toggle UI for screenGrabs, faceDetection, bestClips, camerasTab (Advanced only, hidden in Simple)
- [ ] `components/LeftNav.tsx` -- conditionally show Cameras section per featureFlags.camerasTab
- [ ] `components/BestClipsPanel.tsx` -- conditionally render per featureFlags.bestClips
- [ ] Scoring queue -- skip if bestClips is off

### 9. Dev Menu

- [ ] New: `components/DevMenu.tsx` -- formulas section, camera DB section, license tools section, debug section (raw SQL gated behind DCAM-D)
- [ ] `App.tsx` -- keyboard listener for Cmd+Shift+D / Ctrl+Shift+D
- [ ] `components/SettingsView.tsx` -- version click counter (7 clicks = open dev menu)

### 10. Theme Toggle

CSS is done. Just need the switch.

- [ ] `App.tsx` -- read theme from settings, apply/remove .dark-mode class on document.documentElement
- [ ] `components/SettingsView.tsx` -- theme toggle switch (Advanced mode only, hidden in Simple)

### 11. Terminology Rename (Frontend)

Last. Do after all features work with current names.

- [ ] `components/LibraryView.tsx` --> rename file to `ProjectView.tsx`, update all internal references
- [ ] `components/LibraryDashboard.tsx` --> `ProjectsDashboard.tsx`
- [ ] `components/LibraryCard.tsx` --> `ProjectCard.tsx`
- [ ] `components/nav/LibrarySection.tsx` --> `nav/ProjectSection.tsx`
- [ ] `types/settings.ts` -- AppMode: 'personal'|'pro' > 'simple'|'advanced', RecentLibrary > RecentProject
- [ ] `api/settings.ts` -- rename all library functions to project
- [ ] `api/clips.ts` -- openLibrary > openProject, createLibrary > createProject, getLibraryRoot > getProjectRoot
- [ ] `App.tsx` -- all library/personal/pro references
- [ ] `components/MainLayout.tsx` -- update references
- [ ] `components/LeftNav.tsx` -- update references
- [ ] `components/WelcomeDashboard.tsx` -- UI text: "Open Library" > "Open Project", etc.
- [ ] `components/SettingsView.tsx` -- mode labels: "Personal" > "Simple", "Pro" > "Advanced"
- [ ] `components/SettingsPanel.tsx` -- mode labels
- [ ] `App.css` -- rename .library-* classes to .project-*

---

## File Structure (Final)

### Backend New Files

```
src-tauri/src/
+-- camera/
|   +-- mod.rs                    UPDATE (bundled + custom DB loading)
|   +-- usb.rs                    NEW
|   +-- registration.rs           NEW
+-- commands/
|   +-- library.rs                RENAME commands last (library > project)
|   +-- clips.rs                  UPDATE (camera_id)
|   +-- settings.rs               UPDATE (v2, mode rename last)
|   +-- cameras.rs                NEW
|   +-- export.rs                 NEW
|   +-- license.rs                NEW
|   +-- debug.rs                  NEW
+-- export/
|   +-- mod.rs                    NEW
|   +-- timeline.rs               NEW
|   +-- ffmpeg.rs                 NEW
|   +-- title.rs                  NEW
+-- license/
|   +-- mod.rs                    NEW
|   +-- machine_id.rs             NEW
|   +-- key.rs                    NEW
|   +-- trial.rs                  NEW
|   +-- keychain.rs               NEW
+-- db/
    +-- migrations.rs             UPDATE (migration 4)
```

### Frontend New/Renamed Files

```
src/
+-- components/
|   +-- ProjectView.tsx           RENAME from LibraryView (last)
|   +-- ProjectsDashboard.tsx     RENAME from LibraryDashboard (last)
|   +-- ProjectCard.tsx           RENAME from LibraryCard (last)
|   +-- FirstRunWizard.tsx        NEW
|   +-- CamerasTab.tsx            NEW
|   +-- ImportDialog.tsx          NEW
|   +-- ExportDialog.tsx          NEW
|   +-- DevMenu.tsx               NEW
|   +-- LicensePrompt.tsx         NEW
|   +-- nav/
|       +-- ProjectSection.tsx    RENAME from LibrarySection (last)
|       +-- CamerasSection.tsx    NEW
+-- types/
|   +-- settings.ts               UPDATE (v2)
|   +-- cameras.ts                NEW
|   +-- license.ts                NEW
+-- api/
    +-- cameras.ts                NEW
    +-- export.ts                 NEW
    +-- license.ts                NEW
```

No FavoritesView.tsx or FavoritesSection.tsx. Favorites is a nav link, not a component.

### Resource Files

```
resources/cameras/canonical.json      BUNDLE (when available, not a blocker)

~/.dadcam/
+-- custom_cameras.json               USER (registered Dad Cams)
+-- battery_types.json                USER (build-as-you-go)
+-- chargers.json                     USER (build-as-you-go)
+-- dev-keys.log                      USER (generated rental keys)
```

---

## Non-Negotiables (from contracts.md)

1. Originals NEVER deleted, modified, or moved without explicit user action
2. App works 100% offline, no account required, no telemetry
3. Exports use standard formats, SQLite inspectable, user can access originals
4. Same features on Mac, Windows, Linux
5. Ingest resumable after crash/disconnect

---

## Testing Notes

These features need explicit testing before shipping:

| Feature | What To Test |
|---------|-------------|
| Trial flow | Days 1-11 subtle footer, days 12-14 banner, day 15+ soft lock |
| Soft lock | Import/export/auto-edit blocked, view/browse/play allowed |
| Key validation | Valid key activates, invalid rejected, wrong format rejected |
| Key types | DCAM-P (purchased), DCAM-R (rental), DCAM-D (dev) all work |
| Keychain | Key survives app uninstall on macOS, Windows, Linux |
| Settings migration | v1 settings auto-migrate to v2, mode maps correctly |
| Existing user upgrade | firstRunCompleted=true, wizard skipped, trial starts fresh |
| VHS export | J & L blending audible, title overlay visible, all selection modes |
| Import with event | Clips assigned to correct event, camera detected |
| USB detection | Test on macOS, Windows, Linux (may fail -- fallback to memory card) |
| Feature toggles | Disabling face detection stops ML, cameras tab hides |
| Dev menu access | Cmd+Shift+D works, 7-click easter egg works |
| Raw SQL gating | Only accessible with DCAM-D key |

---

## Implementation Order

| # | What | Backend | Frontend | Depends On |
|---|------|---------|----------|-----------|
| 1 | Settings v2 | settings.rs expansion | types, api | Nothing |
| 2 | Licensing | license/ module (5 files), commands/license.rs | LicensePrompt, trial UI, feature gating | Settings v2 |
| 3 | VHS export | export/ module (4 files), commands/export.rs, jobs/runner.rs | ExportDialog, api/export.ts | Settings v2 (for dev menu config) |
| 4 | Import dialog | ingest updates (event_id, camera, progress events) | ImportDialog.tsx | Nothing |
| 5 | Camera system | camera/ updates, migration 4, commands/cameras.rs | cameras types/api, CamerasTab | Nothing |
| 6 | LeftNav + Favorites | Nothing | LeftNav updates, CamerasSection, favorites link | Camera system (for cameras section) |
| 7 | First-run wizard | Nothing | FirstRunWizard.tsx, App.tsx check | Settings v2 |
| 8 | Feature toggles | Nothing | SettingsView, LeftNav conditionals | Settings v2 |
| 9 | Dev menu | commands/debug.rs | DevMenu.tsx, keyboard listener, easter egg | Settings v2, cameras, licensing |
| 10 | Camera registration | camera/usb.rs, camera/registration.rs | DevMenu camera section | Camera system, dev menu |
| 11 | Theme toggle | Nothing (CSS done) | App.tsx class toggle, SettingsView switch | Settings v2 |
| 12 | Terminology rename | commands, schema, lib.rs | All components, types, API, CSS | Everything else done |

Steps 1-5 can partially overlap. Steps 2 and 3 are the highest value (money + core feature). Step 12 is a clean sweep at the end.

---

End of v0.2.0 Master Plan
